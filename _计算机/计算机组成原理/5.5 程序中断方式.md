- 中断的概念
    发生异常事件或特殊请求，中断现行程序的执行，去处理异常事件或特殊请求，完后再返回中断程序的间断处
## I/O中断的产生
中断源（以打印机为例）
![[Pasted image 20250428213522.png]]
## 程序中断方式的接口电路
1. 配置中断请求触发器、中断屏蔽触发器
    还需要**中断请求标志**，代表有请求
    ![[Pasted image 20250428213905.png]]
    D为1，MASK为0，则INTR发出中断请求
    
2. 排队器
    优先级：低优先级中断会被屏蔽
    排队器：决定优先级最高的设备
    - 硬件实现：CPU内或每一个接口电路中（链式排队器）
        ![[Pasted image 20250428214149.png]]
        链式排队器 
            INTR_1 = 1, INTR_非 = 0，后面变成低电平 
        上面再与一下是因为第一个INTR前的INTP'都会输出1，而实际没有请求
    - 软件实现：查询，优先级表格（Ch8）
3. 中断向量地址形成部件
    找到中断服务程序的入口地址：
        *软件查表*（ch8）
        硬件向量法
            中断号：
            中断向量：中断服务程序的断地址、偏移量组成的向量，有时指程序状态字
            ![[Pasted image 20250428215410.png]]
            输入中只有一个高电平（由排队器筛出）
            跳转指令
            ![[Pasted image 20250806153649.png]]
            设备编码器
            
4. 接口电路的基本组成
    ![[Pasted image 20250428215855.png]]
    
## I/O中断处理过程
#### CPU响应中断的条件和时间
条件：
    允许中断触发器EINT=1
    **开中断**置1、**关中断**置0
时间：
    D=1（随机） 且 MASK=0
    CPU发送中断查询信号，INTR置1
#### 过程
#### 流程
1. 保护现场
    程序断点的保护（中断隐指令，ch9）
    寄存器内容的保护（进栈指令）
2. 中断服务
    中断服务随中断请求源的不同而不同
3. 恢复现场
    出栈指令
4. 中断返回
    中断返回指令
#### 单重中断和多重中断
多重中断：允许**级别更高**的中断源**中断现行的中断服务程序**
单重中断：不允许中断中断
![[Pasted image 20250806161700.png|300]]
主要区别：**开中断**提前至保护现场后，设备服务前

![[Pasted image 20250806162113.png]]
总结：
    宏观上避免了CPU踏步，微观上仍然存在主程序与服务程序对CPU的抢占
    